(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30116,        713]
NotebookOptionsPosition[     28818,        674]
NotebookOutlinePosition[     29229,        692]
CellTagsIndexPosition[     29186,        689]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "\nIn multi-class M/M/1-PS, value function of state x, x is a vector of K \
(number of classes) dimensions, is given by\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Sum]", 
    RowBox[{"\[Sum]", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"i", ",", "j"}]], 
      SubscriptBox["x", "i"], 
      SubscriptBox["x", "j"]}]}]}], TraditionalForm]],ExpressionUUID->
  "399ce128-41ee-4ee5-8d5e-e6eb3f7cf74b"],
 " + ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Sum]", 
    RowBox[{
     SubscriptBox["a", "i"], 
     SubscriptBox["x", "i"]}]}], TraditionalForm]],ExpressionUUID->
  "f354d4e3-a7db-4c1f-9a80-76b078021e9f"],
 ",  (Leino et al.),\nCombining this with the Howard equations, the \
coefficients ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"i", ",", "j"}]], ",", 
    SubscriptBox["a", "i"], "   "}], TraditionalForm]],ExpressionUUID->
  "52ad3b8d-f92d-4417-91fb-773196354caf"],
 "can be determined by solving K ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"+", " ", 
     FractionBox[
      RowBox[{"K", "(", 
       RowBox[{"K", "-", "1"}], ")"}], "2"]}], " ", "+", " ", "K"}], 
   TraditionalForm]],ExpressionUUID->"2649f56b-b871-4467-abb7-e933f830ceea"],
 " linear equations.\nThe value function of a state can then be calculated \
using these coefficients with complexity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    SuperscriptBox["K", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "0eae82bf-36a1-48e2-aa6d-505190ebd9d6"],
 "). "
}], "Text",
 CellFrame->{{0, 0}, {3, 0}},
 CellChangeTimes->{{3.716023110104619*^9, 3.716023381301321*^9}, {
  3.716023971365889*^9, 3.716023972517726*^9}, {3.716029257872757*^9, 
  3.7160292683830833`*^9}, {3.716196214083364*^9, 3.716196337589313*^9}, {
  3.716196410184108*^9, 3.716196698785234*^9}, {3.7162941965676403`*^9, 
  3.716294208030054*^9}},ExpressionUUID->"17bf2c7d-9fb8-44a6-87af-\
8a6134826c47"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"valueFunction", "[", "xvec_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"i", ",", "i"}]], " ", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"xvec", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ")"}], " "}], "2"]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}], "+", " ", 
     RowBox[{"2", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["a", 
            RowBox[{"i", ",", "j"}]], " ", 
           RowBox[{"xvec", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", 
           RowBox[{"xvec", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", 
            RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "xvec", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["a", "i"], " ", 
        RowBox[{"xvec", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"avgCostRate", "[", 
     RowBox[{"arrRates_", ",", "servRates_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"arrRates", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"servRates", "[", 
         RowBox[{"[", "i", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"arrRates", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"servRates", "[", 
           RowBox[{"[", "i", "]"}], "]"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}]}], "]"}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"howardEquation", "[", 
     RowBox[{"xvec_", ",", "arrRates_", ",", "servRates_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{"xvec", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{"xvec", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}], "-", 
        RowBox[{"avgCostRate", "[", 
         RowBox[{"arrRates", ",", "servRates"}], "]"}], " ", "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"arrRates", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"valueFunction", "[", 
              RowBox[{"xvec", "+", 
               RowBox[{"UnitVector", "[", 
                RowBox[{
                 RowBox[{"Length", "[", "xvec", "]"}], ",", "i"}], "]"}]}], 
              "]"}], "-", 
             RowBox[{"valueFunction", "[", "xvec", "]"}]}], ")"}]}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}]}], ")"}]}],
      "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"servRates", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"xvec", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"valueFunction", "[", 
           RowBox[{"xvec", "-", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"Length", "[", "xvec", "]"}], ",", "i"}], "]"}]}], 
           "]"}], "-", 
          RowBox[{"valueFunction", "[", "xvec", "]"}]}], ")"}]}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solveCoefficients", "[", 
     RowBox[{"arrRates_", ",", "servRates_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "xvec", ",", "x", ",", "poly", ",", "eqn", ",", "soln", ",", "i"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xvec", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["x", "i"], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"poly", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "*", "xvec"}], "&"}], "/@", "xvec"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqn", "=", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"howardEquation", "[", 
            RowBox[{"xvec", ",", "arrRates", ",", "servRates"}], "]"}], "//", 
           "Expand"}], ",", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Flatten", "[", "poly", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"soln", " ", "=", " ", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{"eqn", ",", "#"}], "]"}], "\[Equal]", "0"}], ")"}], 
            "&"}], "/@", "poly"}], ",", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"i", ",", "j"}]], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "i", ",", 
               RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}]}], "]"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"soln", "=", 
        RowBox[{"soln", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "arrRates", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"soln", ",", " ", 
           RowBox[{
            SubscriptBox["a", "i"], "\[Rule]", 
            RowBox[{"Replace", "[", 
             RowBox[{
              SubscriptBox["a", 
               RowBox[{"i", ",", "i"}]], ",", "soln"}], "]"}]}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "soln"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellFrame->{{0, 0}, {0.5, 0}},
 CellChangeTimes->{{3.716113957119132*^9, 3.716113957682287*^9}, {
  3.716114018806013*^9, 3.716114246588171*^9}, {3.716114337362114*^9, 
  3.716114341312581*^9}, {3.716114571114688*^9, 3.71611457378479*^9}, {
  3.7161148357794743`*^9, 3.716114993066371*^9}, {3.716115104651518*^9, 
  3.7161151223641853`*^9}, {3.716147354254362*^9, 3.7161474375111837`*^9}, {
  3.7161476356869917`*^9, 3.716147646418583*^9}, {3.71614795868438*^9, 
  3.7161479707599487`*^9}, {3.716176797347261*^9, 3.716176801681538*^9}, {
  3.716176842852256*^9, 3.716176845044485*^9}, {3.716176959239407*^9, 
  3.716176963606996*^9}, {3.7161770146347647`*^9, 3.7161770193684883`*^9}, {
  3.716182188914694*^9, 3.7161822087869577`*^9}, {3.716182367464237*^9, 
  3.716182371303935*^9}},ExpressionUUID->"f87970ff-fed9-4044-8315-\
7dbc78d2bc45"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7161447922060347`*^9, 3.7161448496240396`*^9}, {
   3.716144881140667*^9, 3.7161449057688427`*^9}, {3.7161449586181183`*^9, 
   3.7161450204227667`*^9}, {3.71614507974296*^9, 3.716145087488168*^9}, {
   3.716145162594407*^9, 3.716145163136888*^9}, {3.716146746292265*^9, 
   3.716146788738043*^9}, {3.716146849624607*^9, 3.716146907778385*^9}, {
   3.716147010841384*^9, 3.716147053694768*^9}, {3.716179522891652*^9, 
   3.716179573579138*^9}, {3.716179657198081*^9, 3.7161796639022217`*^9}, {
   3.716179708242062*^9, 3.716179812099325*^9}, {3.7161798734133043`*^9, 
   3.716179921174654*^9}, {3.716179966936899*^9, 3.716179979101344*^9}, {
   3.716180013980575*^9, 3.716180066251609*^9}, {3.716180119199704*^9, 
   3.7161801857083282`*^9}, {3.71618029534725*^9, 3.716180319284381*^9}, {
   3.716180354133071*^9, 3.716180381798459*^9}, {3.7161804593548727`*^9, 
   3.716180479881692*^9}, {3.7161806502713614`*^9, 3.716180652991337*^9}, {
   3.716180769299982*^9, 3.7161807703382196`*^9}, 3.7161808194605513`*^9, {
   3.7161809249699697`*^9, 3.716180960872707*^9}, {3.716181057885277*^9, 
   3.7161810692283278`*^9}, {3.716181288948752*^9, 3.716181297955674*^9}, {
   3.716181387110588*^9, 3.716181399110712*^9}, {3.71618146927463*^9, 
   3.716181508346406*^9}, {3.716181739650997*^9, 3.716181771171432*^9}, {
   3.716181825322751*^9, 3.716181825798245*^9}, 
   3.71618220481769*^9},ExpressionUUID->"268631f2-689b-4f0f-af2e-\
4e01db36ec74"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pythonTuples", "[", "states_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"keys", ",", "key", ",", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"keys", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "states", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"key", "=", "\"\<(\>\""}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", 
              RowBox[{"states", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", "<", 
                RowBox[{"Length", "[", 
                 RowBox[{"states", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"key", "=", 
                RowBox[{"key", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"states", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "<>", 
                 "\"\<,\>\""}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"key", "=", 
                RowBox[{"key", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"states", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}]}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"key", "=", 
           RowBox[{"key", "<>", "\"\<)\>\""}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"keys", ",", "key"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "keys"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"values", "[", 
     RowBox[{
     "arrRates_", ",", " ", "servRates_", ",", " ", "truncation_", ",", " ", 
      RowBox[{"export_:", "0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "loads", ",", "n", ",", "coeffs", ",", "states", ",", "keys", ",", 
        "values", ",", "filename"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", "truncation"}], ";", "\[IndentingNewLine]", 
       RowBox[{"coeffs", " ", "=", " ", 
        RowBox[{"solveCoefficients", "[", 
         RowBox[{"arrRates", ",", "servRates"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"states", " ", "=", " ", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "n"}], "]"}], ",", 
          RowBox[{"Length", "[", "arrRates", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"export", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"values", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "->", 
               RowBox[{"valueFunction", "[", "#", "]"}]}], "/.", "coeffs"}], 
             ")"}], "&"}], "/@", "states"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"loads", "=", 
           RowBox[{"arrRates", "/", "servRates"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"loads", " ", "=", " ", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<-\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", "loads"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"keys", "=", 
           RowBox[{"pythonTuples", "[", "states", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"values", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"keys", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "\[Rule]", 
                RowBox[{"valueFunction", "[", 
                 RowBox[{"states", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "]"}]}], "/.", "coeffs"}], 
              ")"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "states", "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"filename", " ", "=", " ", 
           RowBox[{
           "\"\</Users/misikir/Google\\ \
Drive/EIT-Project/code/value_func_load\>\"", "<>", "loads", "<>", 
            "\"\<.json\>\""}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"filename", ",", "values"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "values"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.716182463432637*^9, 3.716182472120479*^9}, {
   3.7162758426582193`*^9, 3.716276041748713*^9}, {3.71627608832761*^9, 
   3.71627611066257*^9}, {3.716279621753188*^9, 3.7162796459760523`*^9}, {
   3.716280627048225*^9, 3.716280718844528*^9}, {3.716280920066668*^9, 
   3.716280928208951*^9}, {3.716281180028523*^9, 3.71628118962398*^9}, {
   3.7162812220746613`*^9, 3.716281466738001*^9}, {3.716281497829507*^9, 
   3.716281504434957*^9}, {3.716281557495544*^9, 3.716281593094947*^9}, {
   3.716281776142268*^9, 3.71628177719611*^9}, {3.716281844304583*^9, 
   3.7162818485429907`*^9}, 3.716282290288761*^9, {3.716282433523601*^9, 
   3.716282516517983*^9}, {3.716282659851313*^9, 3.716282684713636*^9}, {
   3.71628278559839*^9, 3.7162827958047237`*^9}, {3.7162828609918528`*^9, 
   3.71628286118281*^9}, {3.716282997301252*^9, 3.716283020788144*^9}, {
   3.716283122200569*^9, 3.716283143975058*^9}, {3.7162832575182543`*^9, 
   3.716283258060748*^9}, {3.716283402658128*^9, 3.716283558902121*^9}, {
   3.716283624553555*^9, 3.7162837096101303`*^9}, {3.716283824847224*^9, 
   3.716283850013708*^9}, {3.7162841017688*^9, 3.7162841480083523`*^9}, {
   3.716284263661297*^9, 3.7162843325102873`*^9}, {3.716284380865719*^9, 
   3.7162844186100616`*^9}, {3.7162844916691723`*^9, 3.716284494162908*^9}, {
   3.7162846120092497`*^9, 3.7162846310171413`*^9}, {3.716284667355027*^9, 
   3.716284750300898*^9}, {3.716284830609808*^9, 3.7162848369108953`*^9}, {
   3.7162848840819798`*^9, 3.7162848845447817`*^9}, {3.716285063432543*^9, 
   3.716285113005043*^9}, 3.716285299474956*^9, {3.716285392548807*^9, 
   3.716285433602025*^9}, 3.716285469796577*^9, {3.716286131419428*^9, 
   3.7162861919142857`*^9}, {3.716286227402117*^9, 3.7162862898694353`*^9}, {
   3.716287028214759*^9, 3.716287099508707*^9}, {3.716287218701502*^9, 
   3.71628723333917*^9}, 3.716287277279128*^9, {3.716289074885893*^9, 
   3.7162890881814327`*^9}, {3.716289126407549*^9, 3.716289149191002*^9}, {
   3.716291667513032*^9, 3.716291669145845*^9}, {3.716292027507763*^9, 
   3.716292043605296*^9}, {3.7162923184945107`*^9, 3.716292385551229*^9}, {
   3.716292638746097*^9, 3.7162928268920116`*^9}, {3.716292947714196*^9, 
   3.7162929679389553`*^9}, 3.716293005842373*^9, {3.716293180682234*^9, 
   3.716293233578287*^9}, {3.7162941510317783`*^9, 3.716294167286787*^9}, {
   3.716356975500209*^9, 3.71635701260393*^9}, {3.716363138531033*^9, 
   3.716363156818478*^9}},ExpressionUUID->"633038f7-3cf8-40c1-b72a-\
bd504ce71011"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"(0,0)\"\>", "\[Rule]", "0"}], ",", 
   RowBox[{"\<\"(0,1)\"\>", "\[Rule]", "0.6410256410256411`"}], ",", 
   RowBox[{"\<\"(0,2)\"\>", "\[Rule]", "1.9230769230769234`"}], ",", 
   RowBox[{"\<\"(0,3)\"\>", "\[Rule]", "3.8461538461538467`"}], ",", 
   RowBox[{"\<\"(0,4)\"\>", "\[Rule]", "6.410256410256411`"}], ",", 
   RowBox[{"\<\"(0,5)\"\>", "\[Rule]", "9.615384615384615`"}], ",", 
   RowBox[{"\<\"(1,0)\"\>", "\[Rule]", "1.4102564102564101`"}], ",", 
   RowBox[{"\<\"(1,1)\"\>", "\[Rule]", "2.9487179487179485`"}], ",", 
   RowBox[{"\<\"(1,2)\"\>", "\[Rule]", "5.128205128205128`"}], ",", 
   RowBox[{"\<\"(1,3)\"\>", "\[Rule]", "7.948717948717949`"}], ",", 
   RowBox[{"\<\"(1,4)\"\>", "\[Rule]", "11.410256410256412`"}], ",", 
   RowBox[{"\<\"(1,5)\"\>", "\[Rule]", "15.512820512820513`"}], ",", 
   RowBox[{"\<\"(2,0)\"\>", "\[Rule]", "4.23076923076923`"}], ",", 
   RowBox[{"\<\"(2,1)\"\>", "\[Rule]", "6.666666666666666`"}], ",", 
   RowBox[{"\<\"(2,2)\"\>", "\[Rule]", "9.743589743589743`"}], ",", 
   RowBox[{"\<\"(2,3)\"\>", "\[Rule]", "13.461538461538462`"}], ",", 
   RowBox[{"\<\"(2,4)\"\>", "\[Rule]", "17.820512820512818`"}], ",", 
   RowBox[{"\<\"(2,5)\"\>", "\[Rule]", "22.82051282051282`"}], ",", 
   RowBox[{"\<\"(3,0)\"\>", "\[Rule]", "8.46153846153846`"}], ",", 
   RowBox[{"\<\"(3,1)\"\>", "\[Rule]", "11.794871794871794`"}], ",", 
   RowBox[{"\<\"(3,2)\"\>", "\[Rule]", "15.769230769230768`"}], ",", 
   RowBox[{"\<\"(3,3)\"\>", "\[Rule]", "20.384615384615387`"}], ",", 
   RowBox[{"\<\"(3,4)\"\>", "\[Rule]", "25.641025641025642`"}], ",", 
   RowBox[{"\<\"(3,5)\"\>", "\[Rule]", "31.538461538461533`"}], ",", 
   RowBox[{"\<\"(4,0)\"\>", "\[Rule]", "14.102564102564102`"}], ",", 
   RowBox[{"\<\"(4,1)\"\>", "\[Rule]", "18.333333333333332`"}], ",", 
   RowBox[{"\<\"(4,2)\"\>", "\[Rule]", "23.205128205128204`"}], ",", 
   RowBox[{"\<\"(4,3)\"\>", "\[Rule]", "28.717948717948715`"}], ",", 
   RowBox[{"\<\"(4,4)\"\>", "\[Rule]", "34.87179487179487`"}], ",", 
   RowBox[{"\<\"(4,5)\"\>", "\[Rule]", "41.666666666666664`"}], ",", 
   RowBox[{"\<\"(5,0)\"\>", "\[Rule]", "21.153846153846153`"}], ",", 
   RowBox[{"\<\"(5,1)\"\>", "\[Rule]", "26.28205128205128`"}], ",", 
   RowBox[{"\<\"(5,2)\"\>", "\[Rule]", "32.05128205128205`"}], ",", 
   RowBox[{"\<\"(5,3)\"\>", "\[Rule]", "38.46153846153846`"}], ",", 
   RowBox[{"\<\"(5,4)\"\>", "\[Rule]", "45.51282051282051`"}], ",", 
   RowBox[{"\<\"(5,5)\"\>", "\[Rule]", "53.205128205128204`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.716289091048284*^9, 3.71628915212675*^9, 3.7162920472503033`*^9, {
   3.716292325658346*^9, 3.716292355517668*^9}, 3.716292400885129*^9, {
   3.716292518830544*^9, 3.716292532765609*^9}, {3.7162928047700787`*^9, 
   3.716292828345092*^9}, 3.7162930096197653`*^9, 3.716293239694759*^9, 
   3.716294168613583*^9, {3.716356980341473*^9, 
   3.716357013354788*^9}},ExpressionUUID->"bccd3352-7709-4a0a-bf34-\
0a33dfca6e10"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"soln", "=", 
    RowBox[{"solveCoefficients", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.2", ",", "0.1", ",", "0.15", ",", "0.34"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.", ",", "1.1", ",", "1.3", ",", "2"}], "}"}]}], "]"}]}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.7163630750259666`*^9, 
  3.716363119547428*^9}},ExpressionUUID->"ecbad157-4bbb-4567-9e4e-\
0a8cd0b7a716"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"1", ",", "1"}]], "\[Rule]", "1.3055999231815671`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"1", ",", "2"}]], "\[Rule]", "1.2204676883804466`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"1", ",", "3"}]], "\[Rule]", "1.0792138086703202`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"1", ",", "4"}]], "\[Rule]", "0.7663267600195912`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"2", ",", "2"}]], "\[Rule]", "1.1430747476521554`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"2", ",", "3"}]], "\[Rule]", "1.0141558579906413`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"2", ",", "4"}]], "\[Rule]", "0.7260524449337347`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"3", ",", "3"}]], "\[Rule]", "0.9050706436616682`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"3", ",", "4"}]], "\[Rule]", "0.6575673314052651`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"4", ",", "4"}]], "\[Rule]", "0.4966901784386033`"}], ",", 
   RowBox[{
    SubscriptBox["a", "1"], "\[Rule]", "1.3055999231815671`"}], ",", 
   RowBox[{
    SubscriptBox["a", "2"], "\[Rule]", "1.1430747476521554`"}], ",", 
   RowBox[{
    SubscriptBox["a", "3"], "\[Rule]", "0.9050706436616682`"}], ",", 
   RowBox[{
    SubscriptBox["a", "4"], "\[Rule]", "0.4966901784386033`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.716363123556199*^9},ExpressionUUID->"6ea3e2cf-c8c4-405c-bde6-\
00b43c5859fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"res", " ", "=", " ", 
   RowBox[{"values", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "5", ",", "1"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7163631409173098`*^9, 
  3.7163631418796453`*^9}},ExpressionUUID->"699be9cf-f9fb-4e70-b7ca-\
0e1676036072"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"(0,0)\"\>", "\[Rule]", "0"}], ",", 
   RowBox[{"\<\"(0,1)\"\>", "\[Rule]", "0.6410256410256411`"}], ",", 
   RowBox[{"\<\"(0,2)\"\>", "\[Rule]", "1.9230769230769234`"}], ",", 
   RowBox[{"\<\"(0,3)\"\>", "\[Rule]", "3.8461538461538467`"}], ",", 
   RowBox[{"\<\"(0,4)\"\>", "\[Rule]", "6.410256410256411`"}], ",", 
   RowBox[{"\<\"(0,5)\"\>", "\[Rule]", "9.615384615384615`"}], ",", 
   RowBox[{"\<\"(1,0)\"\>", "\[Rule]", "1.4102564102564101`"}], ",", 
   RowBox[{"\<\"(1,1)\"\>", "\[Rule]", "2.9487179487179485`"}], ",", 
   RowBox[{"\<\"(1,2)\"\>", "\[Rule]", "5.128205128205128`"}], ",", 
   RowBox[{"\<\"(1,3)\"\>", "\[Rule]", "7.948717948717949`"}], ",", 
   RowBox[{"\<\"(1,4)\"\>", "\[Rule]", "11.410256410256412`"}], ",", 
   RowBox[{"\<\"(1,5)\"\>", "\[Rule]", "15.512820512820513`"}], ",", 
   RowBox[{"\<\"(2,0)\"\>", "\[Rule]", "4.23076923076923`"}], ",", 
   RowBox[{"\<\"(2,1)\"\>", "\[Rule]", "6.666666666666666`"}], ",", 
   RowBox[{"\<\"(2,2)\"\>", "\[Rule]", "9.743589743589743`"}], ",", 
   RowBox[{"\<\"(2,3)\"\>", "\[Rule]", "13.461538461538462`"}], ",", 
   RowBox[{"\<\"(2,4)\"\>", "\[Rule]", "17.820512820512818`"}], ",", 
   RowBox[{"\<\"(2,5)\"\>", "\[Rule]", "22.82051282051282`"}], ",", 
   RowBox[{"\<\"(3,0)\"\>", "\[Rule]", "8.46153846153846`"}], ",", 
   RowBox[{"\<\"(3,1)\"\>", "\[Rule]", "11.794871794871794`"}], ",", 
   RowBox[{"\<\"(3,2)\"\>", "\[Rule]", "15.769230769230768`"}], ",", 
   RowBox[{"\<\"(3,3)\"\>", "\[Rule]", "20.384615384615387`"}], ",", 
   RowBox[{"\<\"(3,4)\"\>", "\[Rule]", "25.641025641025642`"}], ",", 
   RowBox[{"\<\"(3,5)\"\>", "\[Rule]", "31.538461538461533`"}], ",", 
   RowBox[{"\<\"(4,0)\"\>", "\[Rule]", "14.102564102564102`"}], ",", 
   RowBox[{"\<\"(4,1)\"\>", "\[Rule]", "18.333333333333332`"}], ",", 
   RowBox[{"\<\"(4,2)\"\>", "\[Rule]", "23.205128205128204`"}], ",", 
   RowBox[{"\<\"(4,3)\"\>", "\[Rule]", "28.717948717948715`"}], ",", 
   RowBox[{"\<\"(4,4)\"\>", "\[Rule]", "34.87179487179487`"}], ",", 
   RowBox[{"\<\"(4,5)\"\>", "\[Rule]", "41.666666666666664`"}], ",", 
   RowBox[{"\<\"(5,0)\"\>", "\[Rule]", "21.153846153846153`"}], ",", 
   RowBox[{"\<\"(5,1)\"\>", "\[Rule]", "26.28205128205128`"}], ",", 
   RowBox[{"\<\"(5,2)\"\>", "\[Rule]", "32.05128205128205`"}], ",", 
   RowBox[{"\<\"(5,3)\"\>", "\[Rule]", "38.46153846153846`"}], ",", 
   RowBox[{"\<\"(5,4)\"\>", "\[Rule]", "45.51282051282051`"}], ",", 
   RowBox[{"\<\"(5,5)\"\>", "\[Rule]", "53.205128205128204`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.716363142534506*^9},ExpressionUUID->"4476b8e4-6bb0-46e8-9c52-\
ed6e98e9a1aa"]
}, Open  ]]
},
WindowSize->{1169, 751},
WindowMargins->{{Automatic, 132}, {Automatic, 53}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 16, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1956, 55, 134, "Text", "ExpressionUUID" -> \
"17bf2c7d-9fb8-44a6-87af-8a6134826c47"],
Cell[2517, 77, 8515, 225, 496, "Input", "ExpressionUUID" -> \
"f87970ff-fed9-4044-8315-7dbc78d2bc45"],
Cell[11035, 304, 1489, 21, 32, "Input", "ExpressionUUID" -> \
"268631f2-689b-4f0f-af2e-4e01db36ec74"],
Cell[CellGroupData[{
Cell[12549, 329, 8031, 168, 726, "Input", "ExpressionUUID" -> \
"633038f7-3cf8-40c1-b72a-bd504ce71011"],
Cell[20583, 499, 2985, 47, 117, "Output", "ExpressionUUID" -> \
"bccd3352-7709-4a0a-bf34-0a33dfca6e10"]
}, Closed]],
Cell[CellGroupData[{
Cell[23605, 551, 500, 13, 90, "Input", "ExpressionUUID" -> \
"ecbad157-4bbb-4567-9e4e-0a8cd0b7a716"],
Cell[24108, 566, 1566, 44, 58, "Output", "ExpressionUUID" -> \
"6ea3e2cf-c8c4-405c-bde6-00b43c5859fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25711, 615, 444, 12, 75, "Input", "ExpressionUUID" -> \
"699be9cf-f9fb-4e70-b7ca-0e1676036072"],
Cell[26158, 629, 2644, 42, 117, "Output", "ExpressionUUID" -> \
"4476b8e4-6bb0-46e8-9c52-ed6e98e9a1aa"]
}, Open  ]]
}
]
*)

