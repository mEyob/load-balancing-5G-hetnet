(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45923,       1121]
NotebookOptionsPosition[     44016,       1070]
NotebookOutlinePosition[     44426,       1088]
CellTagsIndexPosition[     44383,       1085]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "\nIn multi-class M/M/1-PS, value function of state x, x is a vector of K \
(number of classes) dimensions, is given by\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Sum]", 
    RowBox[{"\[Sum]", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"i", ",", "j"}]], 
      SubscriptBox["x", "i"], 
      SubscriptBox["x", "j"]}]}]}], TraditionalForm]],ExpressionUUID->
  "399ce128-41ee-4ee5-8d5e-e6eb3f7cf74b"],
 " + ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Sum]", 
    RowBox[{
     SubscriptBox["a", "i"], 
     SubscriptBox["x", "i"]}]}], TraditionalForm]],ExpressionUUID->
  "f354d4e3-a7db-4c1f-9a80-76b078021e9f"],
 ",  (Leino et al.),\nCombining this with the Howard equations, the \
coefficients ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"i", ",", "j"}]], ",", 
    SubscriptBox["a", "i"], "   "}], TraditionalForm]],ExpressionUUID->
  "52ad3b8d-f92d-4417-91fb-773196354caf"],
 "can be determined by solving K ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"+", " ", 
     FractionBox[
      RowBox[{"K", "(", 
       RowBox[{"K", "-", "1"}], ")"}], "2"]}], " ", "+", " ", "K"}], 
   TraditionalForm]],ExpressionUUID->"2649f56b-b871-4467-abb7-e933f830ceea"],
 " linear equations.\nThe value function of a state can then be calculated \
using these coefficients with complexity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    SuperscriptBox["K", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "0eae82bf-36a1-48e2-aa6d-505190ebd9d6"],
 "). "
}], "Text",
 CellFrame->{{0, 0}, {3, 0}},
 CellChangeTimes->{{3.716023110104619*^9, 3.716023381301321*^9}, {
  3.716023971365889*^9, 3.716023972517726*^9}, {3.716029257872757*^9, 
  3.7160292683830833`*^9}, {3.716196214083364*^9, 3.716196337589313*^9}, {
  3.716196410184108*^9, 3.716196698785234*^9}, {3.7162941965676403`*^9, 
  3.716294208030054*^9}},ExpressionUUID->"17bf2c7d-9fb8-44a6-87af-\
8a6134826c47"],

Cell["\<\

Performance value functions\
\>", "Text",
 CellChangeTimes->{{3.716717813451705*^9, 
  3.716717828413835*^9}},ExpressionUUID->"73e6c6ba-35de-4dd5-8ce5-\
66026fd8007e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"valueFunction", "[", "xvec_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"i", ",", "i"}]], " ", 
        SuperscriptBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"xvec", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ")"}], " "}], "2"]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}], "+", " ", 
     RowBox[{"2", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["a", 
            RowBox[{"i", ",", "j"}]], " ", 
           RowBox[{"xvec", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", 
           RowBox[{"xvec", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", 
            RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "xvec", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["a", "i"], " ", 
        RowBox[{"xvec", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"avgCostRate", "[", 
     RowBox[{"arrRates_", ",", "servRates_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"arrRates", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"servRates", "[", 
         RowBox[{"[", "i", "]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"arrRates", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"servRates", "[", 
           RowBox[{"[", "i", "]"}], "]"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}]}], "]"}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"howardEquation", "[", 
     RowBox[{"xvec_", ",", "arrRates_", ",", "servRates_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{"xvec", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sum", "[", " ", 
         RowBox[{
          RowBox[{"xvec", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}], "-", 
        RowBox[{"avgCostRate", "[", 
         RowBox[{"arrRates", ",", "servRates"}], "]"}], " ", "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"arrRates", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"valueFunction", "[", 
              RowBox[{"xvec", "+", 
               RowBox[{"UnitVector", "[", 
                RowBox[{
                 RowBox[{"Length", "[", "xvec", "]"}], ",", "i"}], "]"}]}], 
              "]"}], "-", 
             RowBox[{"valueFunction", "[", "xvec", "]"}]}], ")"}]}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}]}], ")"}]}],
      "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"servRates", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"xvec", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"valueFunction", "[", 
           RowBox[{"xvec", "-", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"Length", "[", "xvec", "]"}], ",", "i"}], "]"}]}], 
           "]"}], "-", 
          RowBox[{"valueFunction", "[", "xvec", "]"}]}], ")"}]}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], 
      "]"}]}]}]}]}]], "Input",
 CellFrame->{{0, 0}, {0.5, 0}},
 CellChangeTimes->{{3.716113957119132*^9, 3.716113957682287*^9}, {
  3.716114018806013*^9, 3.716114246588171*^9}, {3.716114337362114*^9, 
  3.716114341312581*^9}, {3.716114571114688*^9, 3.71611457378479*^9}, {
  3.7161148357794743`*^9, 3.716114993066371*^9}, {3.716115104651518*^9, 
  3.7161151223641853`*^9}, {3.716147354254362*^9, 3.7161474375111837`*^9}, {
  3.7161476356869917`*^9, 3.716147646418583*^9}, {3.71614795868438*^9, 
  3.7161479707599487`*^9}, {3.716176797347261*^9, 3.716176801681538*^9}, {
  3.716176842852256*^9, 3.716176845044485*^9}, {3.716176959239407*^9, 
  3.716176963606996*^9}, {3.7161770146347647`*^9, 3.7161770193684883`*^9}, {
  3.716182188914694*^9, 3.7161822087869577`*^9}, {3.716182367464237*^9, 
  3.716182371303935*^9}, {3.7167169318449287`*^9, 3.7167170213171673`*^9}, {
  3.716717251980658*^9, 3.71671732611981*^9}, {3.716725542693179*^9, 
  3.716725544770217*^9}},ExpressionUUID->"f87970ff-fed9-4044-8315-\
7dbc78d2bc45"],

Cell["\<\
Energy value functions
\
\>", "Text",
 CellChangeTimes->{{3.7167173905084057`*^9, 3.7167173962754917`*^9}, {
  3.716717789950432*^9, 
  3.716717806141899*^9}},ExpressionUUID->"5af5665c-3b13-462c-9c29-\
153c4935cba2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"power", "[", 
   RowBox[{"xvec_", ",", " ", "idlePower_", ",", " ", "busyPower_"}], "]"}], ":=", 
  RowBox[{"Piecewise", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"idlePower", ",", " ", 
       RowBox[{
        RowBox[{"Total", "[", "xvec", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"busyPower", ",", " ", 
       RowBox[{
        RowBox[{"Total", "[", "xvec", "]"}], "!=", "0"}]}], "}"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"avgEnergyCostRate", "[", 
   RowBox[{
   "arrRates_", ",", "servRates_", ",", " ", "idlePower_", ",", " ", 
    "busyPower_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"arrRates", "/", "servRates"}], "]"}], "*", "busyPower"}], " ", 
   "+", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Total", "[", 
       RowBox[{"arrRates", "/", "servRates"}], "]"}]}], ")"}], "*", 
    "idlePower"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyHowardEquation", "[", 
   RowBox[{
   "xvec_", ",", "arrRates_", ",", "servRates_", ",", " ", "idlePower_", ",", 
    " ", "busyPower_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Sum", "[", " ", 
       RowBox[{
        RowBox[{"xvec", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"power", "[", 
         RowBox[{"xvec", ",", "idlePower", ",", "busyPower"}], "]"}], "-", 
        RowBox[{"avgEnergyCostRate", "[", 
         RowBox[{
         "arrRates", ",", "servRates", ",", " ", "idlePower", ",", " ", 
          "busyPower"}], "]"}], " ", "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"arrRates", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"valueFunction", "[", 
              RowBox[{"xvec", "+", 
               RowBox[{"UnitVector", "[", 
                RowBox[{
                 RowBox[{"Length", "[", "xvec", "]"}], ",", "i"}], "]"}]}], 
              "]"}], "-", 
             RowBox[{"valueFunction", "[", "xvec", "]"}]}], ")"}]}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}]}], ")"}]}],
      "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"servRates", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"xvec", "[", 
         RowBox[{"[", "i", "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"valueFunction", "[", 
           RowBox[{"xvec", "-", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"Length", "[", "xvec", "]"}], ",", "i"}], "]"}]}], 
           "]"}], "-", 
          RowBox[{"valueFunction", "[", "xvec", "]"}]}], ")"}]}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "xvec", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellFrame->{{0, 0}, {0.5, 0}},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/e784iNv1r929Lm6FUzfORV5Bsy/dOkFiC6Ypv0F
RK9iWAWm21YnC74F0gyyO8F0yccKIxC9TV7JDUTb3BQJAdEZy73DQPQeZQ/h
v0B6XvQGWRB97XepGYjmSD1rDqILn12NA9ENgREJIPqwzOpi7g2vHTXPm5aA
6HWu0ZUgOidnIZi2XPm8HUQ35xR3gOh//lf6QPSKU9n9IFrHda4oH5A+pCcp
AaI5br/TBtHXdmbqgOgVnNUGwhuB7lRbZQ2iexPrI0B0h3JhOogWuutdAKL/
dNSUgWirEy41INqVeUEbiGa6UTsBRJvtUZoFogGBsKof
  
  "],ExpressionUUID->"86d263fd-550e-4eb4-b5cf-cc718016e357"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solveCoefficients", "[", 
   RowBox[{
   "arrRates_", ",", "servRates_", ",", " ", "idlePower_", ",", " ", 
    "busyPower_", ",", " ", 
    RowBox[{"energy_:", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xvec", ",", "x", ",", "poly", ",", "eqn", ",", "variables", ",", 
      "linear", ",", "soln", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xvec", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["x", "i"], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"poly", " ", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "*", "xvec"}], "&"}], "/@", "xvec"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"poly", ",", "xvec"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"poly", " ", "=", " ", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Flatten", "[", "poly", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"energy", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"eqn", "=", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"howardEquation", "[", 
            RowBox[{"xvec", ",", "arrRates", ",", "servRates"}], "]"}], "//", 
           "Expand"}], ",", "poly"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"eqn", "=", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"energyHowardEquation", "[", 
            RowBox[{
            "xvec", ",", "arrRates", ",", "servRates", ",", " ", "idlePower", 
             ",", " ", "busyPower"}], "]"}], "//", "Expand"}], ",", "poly"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"variables", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "i", ",", 
           RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"linear", " ", "=", " ", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        SubscriptBox["a", "i"], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "arrRates", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"variables", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"variables", ",", "linear"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"soln", " ", "=", " ", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{"eqn", ",", "#"}], "]"}], "\[Equal]", "0"}], ")"}], 
          "&"}], "/@", "poly"}], ",", " ", "variables"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"soln", "=", 
      RowBox[{"soln", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"energy", "\[NotEqual]", "0"}], ",", " ", 
       RowBox[{"soln", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"soln", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Total", "[", "xvec", "]"}], "\[Rule]", "0"}], "}"}]}], 
          ",", " ", 
          RowBox[{"soln", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Total", "[", "xvec", "]"}], "\[Rule]", "1"}], "}"}]}]}],
          "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"soln", "=", 
         RowBox[{"<|", "soln", "|>"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "linear", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{"soln", "[", 
            SubscriptBox["a", "i"], "]"}], "=", 
           RowBox[{"soln", "[", 
            SubscriptBox["a", 
             RowBox[{"i", ",", "i"}]], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"soln", "=", 
         RowBox[{"Normal", "[", "soln", "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "soln"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellFrame->{{0, 0}, {0.5, 0}},
 CellChangeTimes->{{3.716113957119132*^9, 3.716113957682287*^9}, {
   3.716114018806013*^9, 3.716114246588171*^9}, {3.716114337362114*^9, 
   3.716114341312581*^9}, {3.716114571114688*^9, 3.71611457378479*^9}, {
   3.7161148357794743`*^9, 3.716114993066371*^9}, {3.716115104651518*^9, 
   3.7161151223641853`*^9}, {3.716147354254362*^9, 3.7161474375111837`*^9}, {
   3.7161476356869917`*^9, 3.716147646418583*^9}, {3.71614795868438*^9, 
   3.7161479707599487`*^9}, {3.716176797347261*^9, 3.716176801681538*^9}, {
   3.716176842852256*^9, 3.716176845044485*^9}, {3.716176959239407*^9, 
   3.716176963606996*^9}, {3.7161770146347647`*^9, 3.7161770193684883`*^9}, {
   3.716182188914694*^9, 3.7161822087869577`*^9}, {3.716182367464237*^9, 
   3.716182371303935*^9}, {3.7167169318449287`*^9, 3.7167170213171673`*^9}, {
   3.716717251980658*^9, 3.716717340862133*^9}, {3.7167178590091877`*^9, 
   3.716717970184203*^9}, 3.716718151757453*^9, {3.7167194645957527`*^9, 
   3.716719574876528*^9}, {3.716719614599638*^9, 3.7167196211436243`*^9}, {
   3.7167199180666027`*^9, 3.716719932355525*^9}, {3.716720576844297*^9, 
   3.716720605403288*^9}, {3.71672139370541*^9, 3.716721515502945*^9}, {
   3.716721668917153*^9, 3.716721681461028*^9}, {3.716721860124235*^9, 
   3.716721950702405*^9}, {3.716721990562644*^9, 3.7167219946239767`*^9}, {
   3.71672203351976*^9, 3.716722033857149*^9}, {3.716722141317425*^9, 
   3.716722141604982*^9}, {3.716722878097204*^9, 3.716722878689062*^9}, {
   3.716724107664494*^9, 3.716724176896729*^9}, {3.7167245769286013`*^9, 
   3.716724587119856*^9}, 3.716724889856264*^9, {3.7167266247342873`*^9, 
   3.716726642045672*^9}, {3.7167274123323298`*^9, 3.7167275213584967`*^9}, {
   3.716727572834259*^9, 3.716727636291786*^9}, {3.716727771818131*^9, 
   3.716727773528162*^9}},ExpressionUUID->"6798ca66-f737-4285-8b9c-\
d0d601c5fa71"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"energyValue", "[", 
    RowBox[{"state_", ",", "coeffs_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xvec", ",", "x", ",", "coeff", ",", "value"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeff", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", "state", "]"}], " ", "\[Equal]", " ", "0"}], 
         ",", " ", 
         RowBox[{"coeffs", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
         RowBox[{"coeffs", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"value", " ", "=", " ", 
       RowBox[{
        RowBox[{"valueFunction", "[", "state", "]"}], "/.", "coeff"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "coeff", "]"}], ";", "\[IndentingNewLine]", 
      "value"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellFrame->{{0, 0}, {0.5, 0}},
 CellChangeTimes->{{3.7161447922060347`*^9, 3.7161448496240396`*^9}, {
   3.716144881140667*^9, 3.7161449057688427`*^9}, {3.7161449586181183`*^9, 
   3.7161450204227667`*^9}, {3.71614507974296*^9, 3.716145087488168*^9}, {
   3.716145162594407*^9, 3.716145163136888*^9}, {3.716146746292265*^9, 
   3.716146788738043*^9}, {3.716146849624607*^9, 3.716146907778385*^9}, {
   3.716147010841384*^9, 3.716147053694768*^9}, {3.716179522891652*^9, 
   3.716179573579138*^9}, {3.716179657198081*^9, 3.7161796639022217`*^9}, {
   3.716179708242062*^9, 3.716179812099325*^9}, {3.7161798734133043`*^9, 
   3.716179921174654*^9}, {3.716179966936899*^9, 3.716179979101344*^9}, {
   3.716180013980575*^9, 3.716180066251609*^9}, {3.716180119199704*^9, 
   3.7161801857083282`*^9}, {3.71618029534725*^9, 3.716180319284381*^9}, {
   3.716180354133071*^9, 3.716180381798459*^9}, {3.7161804593548727`*^9, 
   3.716180479881692*^9}, {3.7161806502713614`*^9, 3.716180652991337*^9}, {
   3.716180769299982*^9, 3.7161807703382196`*^9}, 3.7161808194605513`*^9, {
   3.7161809249699697`*^9, 3.716180960872707*^9}, {3.716181057885277*^9, 
   3.7161810692283278`*^9}, {3.716181288948752*^9, 3.716181297955674*^9}, {
   3.716181387110588*^9, 3.716181399110712*^9}, {3.71618146927463*^9, 
   3.716181508346406*^9}, {3.716181739650997*^9, 3.716181771171432*^9}, {
   3.716181825322751*^9, 3.716181825798245*^9}, 3.71618220481769*^9, {
   3.7166231561439257`*^9, 3.716623166288383*^9}, {3.716623317079279*^9, 
   3.716623344889838*^9}, {3.716623436925602*^9, 3.716623478925477*^9}, {
   3.716623532511245*^9, 3.716623533551572*^9}, 3.716623569714796*^9, {
   3.716722888432117*^9, 3.716722891759623*^9}, {3.716722958355483*^9, 
   3.716723004675412*^9}, {3.716723050134049*^9, 3.7167231226964684`*^9}, {
   3.716723156490024*^9, 3.716723182265512*^9}, {3.7167243395739307`*^9, 
   3.7167243467745*^9}, {3.716724393177927*^9, 3.716724413369834*^9}, {
   3.716724698707717*^9, 3.716724705140573*^9}, {3.71808428163809*^9, 
   3.718084288486217*^9}, {3.718084367046627*^9, 
   3.718084368567749*^9}},ExpressionUUID->"268631f2-689b-4f0f-af2e-\
4e01db36ec74"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pythonTuples", "[", "states_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"keys", ",", "key", ",", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"keys", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "states", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"key", "=", "\"\<(\>\""}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", 
              RowBox[{"states", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", "<", 
                RowBox[{"Length", "[", 
                 RowBox[{"states", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"key", "=", 
                RowBox[{"key", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"states", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "<>", 
                 "\"\<,\>\""}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"key", "=", 
                RowBox[{"key", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"states", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}]}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"key", "=", 
           RowBox[{"key", "<>", "\"\<)\>\""}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"keys", ",", "key"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "keys"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"values", "[", 
     RowBox[{
     "arrRates_", ",", " ", "servRates_", ",", " ", "truncation_", ",", " ", 
      "idlePower_", ",", " ", "busyPower_", ",", " ", 
      RowBox[{"export_:", "0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "loads", ",", "n", ",", "perfCoeffs", ",", "energyCoeffs", ",", 
        "states", ",", "keys", ",", "values", ",", "filename"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", "truncation"}], ";", "\[IndentingNewLine]", 
       RowBox[{"perfCoeffs", " ", "=", " ", 
        RowBox[{"solveCoefficients", "[", 
         RowBox[{
         "arrRates", ",", "servRates", ",", "idlePower", ",", "busyPower", 
          ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"energyCoeffs", " ", "=", " ", 
        RowBox[{"solveCoefficients", "[", 
         RowBox[{
         "arrRates", ",", "servRates", ",", "idlePower", ",", "busyPower", 
          ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"states", " ", "=", " ", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "n"}], "]"}], ",", 
          RowBox[{"Length", "[", "arrRates", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"export", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"values", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"valueFunction", "[", 
                   RowBox[{"states", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "/.", 
                  "perfCoeffs"}], ")"}], ",", " ", 
                RowBox[{"energyValue", "[", 
                 RowBox[{
                  RowBox[{"states", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], ",", " ", "energyCoeffs"}],
                  "]"}]}], "}"}]}], ")"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "states", "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"keys", "=", 
           RowBox[{"pythonTuples", "[", "states", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"values", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"keys", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"valueFunction", "[", 
                   RowBox[{"states", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "/.", 
                  "perfCoeffs"}], ",", " ", 
                 RowBox[{"energyValue", "[", 
                  RowBox[{
                   RowBox[{"states", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ",", " ", 
                   "energyCoeffs"}], "]"}]}], "}"}]}], ")"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "states", "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"loads", "=", 
           RowBox[{"arrRates", "/", "servRates"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"loads", " ", "=", " ", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<-\>\"", "<>", 
               RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", "loads"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"filename", " ", "=", " ", 
           RowBox[{
           "\"\</Users/misikir/Google\\ \
Drive/EIT-Project/code/state_values_load\>\"", "<>", "loads", "<>", 
            "\"\<.json\>\""}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"filename", ",", "values"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"values", ",", " ", "perfCoeffs"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.716182463432637*^9, 3.716182472120479*^9}, {
   3.7162758426582193`*^9, 3.716276041748713*^9}, {3.71627608832761*^9, 
   3.71627611066257*^9}, {3.716279621753188*^9, 3.7162796459760523`*^9}, {
   3.716280627048225*^9, 3.716280718844528*^9}, {3.716280920066668*^9, 
   3.716280928208951*^9}, {3.716281180028523*^9, 3.71628118962398*^9}, {
   3.7162812220746613`*^9, 3.716281466738001*^9}, {3.716281497829507*^9, 
   3.716281504434957*^9}, {3.716281557495544*^9, 3.716281593094947*^9}, {
   3.716281776142268*^9, 3.71628177719611*^9}, {3.716281844304583*^9, 
   3.7162818485429907`*^9}, 3.716282290288761*^9, {3.716282433523601*^9, 
   3.716282516517983*^9}, {3.716282659851313*^9, 3.716282684713636*^9}, {
   3.71628278559839*^9, 3.7162827958047237`*^9}, {3.7162828609918528`*^9, 
   3.71628286118281*^9}, {3.716282997301252*^9, 3.716283020788144*^9}, {
   3.716283122200569*^9, 3.716283143975058*^9}, {3.7162832575182543`*^9, 
   3.716283258060748*^9}, {3.716283402658128*^9, 3.716283558902121*^9}, {
   3.716283624553555*^9, 3.7162837096101303`*^9}, {3.716283824847224*^9, 
   3.716283850013708*^9}, {3.7162841017688*^9, 3.7162841480083523`*^9}, {
   3.716284263661297*^9, 3.7162843325102873`*^9}, {3.716284380865719*^9, 
   3.7162844186100616`*^9}, {3.7162844916691723`*^9, 3.716284494162908*^9}, {
   3.7162846120092497`*^9, 3.7162846310171413`*^9}, {3.716284667355027*^9, 
   3.716284750300898*^9}, {3.716284830609808*^9, 3.7162848369108953`*^9}, {
   3.7162848840819798`*^9, 3.7162848845447817`*^9}, {3.716285063432543*^9, 
   3.716285113005043*^9}, 3.716285299474956*^9, {3.716285392548807*^9, 
   3.716285433602025*^9}, 3.716285469796577*^9, {3.716286131419428*^9, 
   3.7162861919142857`*^9}, {3.716286227402117*^9, 3.7162862898694353`*^9}, {
   3.716287028214759*^9, 3.716287099508707*^9}, {3.716287218701502*^9, 
   3.71628723333917*^9}, 3.716287277279128*^9, {3.716289074885893*^9, 
   3.7162890881814327`*^9}, {3.716289126407549*^9, 3.716289149191002*^9}, {
   3.716291667513032*^9, 3.716291669145845*^9}, {3.716292027507763*^9, 
   3.716292043605296*^9}, {3.7162923184945107`*^9, 3.716292385551229*^9}, {
   3.716292638746097*^9, 3.7162928268920116`*^9}, {3.716292947714196*^9, 
   3.7162929679389553`*^9}, 3.716293005842373*^9, {3.716293180682234*^9, 
   3.716293233578287*^9}, {3.7162941510317783`*^9, 3.716294167286787*^9}, {
   3.716356975500209*^9, 3.71635701260393*^9}, {3.716363138531033*^9, 
   3.716363156818478*^9}, {3.7166222608452253`*^9, 3.7166222653612003`*^9}, {
   3.716622928206963*^9, 3.716622998013178*^9}, {3.716623039007881*^9, 
   3.7166230435662813`*^9}, {3.716623108498308*^9, 3.716623127041832*^9}, {
   3.716623716425336*^9, 3.716623724887888*^9}, {3.716623756457412*^9, 
   3.716623758153808*^9}, 3.716623802189939*^9, {3.71662421878046*^9, 
   3.716624236250428*^9}, {3.7167180520423393`*^9, 3.7167180564577427`*^9}, {
   3.716722862417985*^9, 3.716722866880826*^9}, {3.7167232487035437`*^9, 
   3.716723254270191*^9}, {3.716723348419114*^9, 3.716723451541568*^9}, 
   3.716723528299461*^9, {3.716723579212154*^9, 3.716723594524497*^9}, 
   3.7167242831102962`*^9, 3.716724328585129*^9, 3.7167244406358128`*^9, 
   3.716725456772192*^9, {3.7167254968515263`*^9, 3.7167254972344627`*^9}, {
   3.7167257220437307`*^9, 3.716725732699675*^9}, {3.716725792494589*^9, 
   3.716725796557382*^9}, {3.716726311746401*^9, 3.716726382916123*^9}, {
   3.716726442836399*^9, 3.716726450101487*^9}, {3.716727818857882*^9, 
   3.716727827450758*^9}},ExpressionUUID->"633038f7-3cf8-40c1-b72a-\
bd504ce71011"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"soln", "=", 
    RowBox[{"solveCoefficients", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.1", ",", "0.9"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "100", ",", "700", ",", "1"}], 
     "]"}]}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.7163630750259666`*^9, 3.716363119547428*^9}, {
   3.716718118763873*^9, 3.716718122010041*^9}, {3.716718185180894*^9, 
   3.7167181853409348`*^9}, {3.71671972508295*^9, 3.7167197281528788`*^9}, {
   3.716720461286924*^9, 3.7167204615726337`*^9}, {3.716720643709393*^9, 
   3.71672067034939*^9}, {3.716720725808735*^9, 3.716720725902533*^9}, {
   3.716722273946951*^9, 3.7167222772887363`*^9}, {3.716724544831566*^9, 
   3.7167245578063383`*^9}, 3.716724936508832*^9, {3.716726765041202*^9, 
   3.71672678153723*^9}, {3.7167268694294977`*^9, 3.716726896278084*^9}, 
   3.718083700530779*^9},ExpressionUUID->"ecbad157-4bbb-4567-9e4e-\
0a8cd0b7a716"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "1"}]], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "2"}]], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      SubscriptBox["a", "1"], "\[Rule]", 
      RowBox[{"-", "733.3333333333334`"}]}], ",", 
     RowBox[{
      SubscriptBox["a", "2"], "\[Rule]", 
      RowBox[{"-", "366.6666666666666`"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "1"}]], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "2"}]], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      SubscriptBox["a", "1"], "\[Rule]", "599.9999999999997`"}], ",", 
     RowBox[{
      SubscriptBox["a", "2"], "\[Rule]", "299.99999999999983`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.716720630660754*^9, 3.716720671829576*^9}, {
   3.7167207221194057`*^9, 3.716720726648594*^9}, 3.7167215223983507`*^9, 
   3.716721687519595*^9, 3.7167219580690393`*^9, 3.7167220414781427`*^9, 
   3.7167221487189703`*^9, 3.716722281388699*^9, 3.7167237491227016`*^9, 
   3.7167244495418777`*^9, {3.716724546024881*^9, 3.716724558738648*^9}, 
   3.716724618062612*^9, 3.716724938492358*^9, 3.716725669842976*^9, {
   3.7167258692944803`*^9, 3.716725888811195*^9}, 3.71672617556075*^9, 
   3.7167267460355873`*^9, 3.716726787538103*^9, {3.716726871344501*^9, 
   3.716726897102941*^9}, 3.7167276702179813`*^9, {3.71672776738225*^9, 
   3.7167277899250317`*^9}, 3.7167287969021397`*^9, 3.718083701701066*^9, 
   3.7180844014123583`*^9},ExpressionUUID->"1df465d3-fa1b-4b8d-81b7-\
cebf7c196187"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"energyValue", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", "soln"}], "]"}]], "Input",
 CellChangeTimes->{{3.7163631409173098`*^9, 3.7163631418796453`*^9}, {
   3.716723625677004*^9, 3.716723629019253*^9}, 3.7167253948473177`*^9, 
   3.7167278442017*^9, {3.7180842382923107`*^9, 
   3.718084271377767*^9}},ExpressionUUID->"699be9cf-f9fb-4e70-b7ca-\
0e1676036072"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"1", ",", "1"}]], "\[Rule]", "0.`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"1", ",", "2"}]], "\[Rule]", "0.`"}], ",", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"2", ",", "2"}]], "\[Rule]", "0.`"}], ",", 
   RowBox[{
    SubscriptBox["a", "1"], "\[Rule]", "599.9999999999997`"}], ",", 
   RowBox[{
    SubscriptBox["a", "2"], "\[Rule]", "299.99999999999983`"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{3.718084293805667*^9, 3.718084373502082*^9, 
  3.718084404361236*^9},ExpressionUUID->"2b1efc68-ae8d-4273-b803-\
ac00497e82de"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.718084273685492*^9, 3.71808429381136*^9}, 
   3.7180843735095587`*^9, 
   3.718084404368692*^9},ExpressionUUID->"e2a90ef5-751b-4ff4-b9f9-\
f80fd00c46a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res", " ", "=", " ", 
  RowBox[{"values", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", "5", ",", "100", ",", "700", ",", 
    "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7163631409173098`*^9, 3.7163631418796453`*^9}, {
   3.716723625677004*^9, 3.716723629019253*^9}, 3.7167253948473177`*^9, 
   3.7167278442017*^9, {3.7180842382923107`*^9, 
   3.718084271377767*^9}},ExpressionUUID->"c0b6c898-c0dc-4891-ba5b-\
070715350e2a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"(0,0)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], ",", 
     RowBox[{"\<\"(0,1)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.6410256410256411`", ",", "299.99999999999994`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"(0,2)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1.9230769230769234`", ",", "599.9999999999999`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"(0,3)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"3.8461538461538467`", ",", "899.9999999999998`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"(0,4)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"6.410256410256411`", ",", "1199.9999999999998`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"(0,5)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"9.615384615384615`", ",", "1499.9999999999998`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"(1,0)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1.4102564102564104`", ",", "600.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(1,1)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"2.948717948717949`", ",", "900.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(1,2)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"5.128205128205128`", ",", "1200.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(1,3)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"7.948717948717949`", ",", "1499.9999999999998`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"(1,4)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"11.410256410256412`", ",", "1799.9999999999998`"}], "}"}]}], 
     ",", 
     RowBox[{"\<\"(1,5)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"15.512820512820513`", ",", "2100.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(2,0)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"4.230769230769231`", ",", "1200.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(2,1)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"6.666666666666666`", ",", "1500.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(2,2)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"9.743589743589745`", ",", "1800.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(2,3)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"13.461538461538463`", ",", "2100.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(2,4)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"17.820512820512818`", ",", "2400.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(2,5)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"22.820512820512825`", ",", "2700.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(3,0)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"8.461538461538462`", ",", "1800.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(3,1)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"11.794871794871796`", ",", "2100.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(3,2)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"15.769230769230768`", ",", "2400.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(3,3)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"20.384615384615387`", ",", "2700.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(3,4)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"25.641025641025642`", ",", "3000.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(3,5)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"31.538461538461537`", ",", "3300.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(4,0)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"14.102564102564104`", ",", "2400.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(4,1)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"18.333333333333332`", ",", "2700.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(4,2)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"23.205128205128204`", ",", "3000.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(4,3)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"28.71794871794872`", ",", "3300.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(4,4)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"34.871794871794876`", ",", "3600.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(4,5)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"41.666666666666664`", ",", "3900.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(5,0)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"21.153846153846153`", ",", "3000.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(5,1)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"26.28205128205128`", ",", "3300.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(5,2)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"32.05128205128205`", ",", "3600.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(5,3)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"38.46153846153846`", ",", "3900.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(5,4)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"45.51282051282051`", ",", "4200.`"}], "}"}]}], ",", 
     RowBox[{"\<\"(5,5)\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"53.205128205128204`", ",", "4500.`"}], "}"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "1"}]], "\[Rule]", "0.7051282051282052`"}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "2"}]], "\[Rule]", "0.4487179487179487`"}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]], "\[Rule]", "0.32051282051282054`"}], ",", 
     RowBox[{
      SubscriptBox["a", "1"], "\[Rule]", "0.7051282051282052`"}], ",", 
     RowBox[{
      SubscriptBox["a", "2"], "\[Rule]", "0.32051282051282054`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.716363142534506*^9, 3.716622302809203*^9, 3.716623617850739*^9, 
   3.7166236540668287`*^9, 3.716623733792169*^9, 3.716623765948833*^9, 
   3.7166241900812283`*^9, 3.716624242421174*^9, {3.716723611021874*^9, 
   3.716723630530932*^9}, 3.716724463180138*^9, 3.716724650450069*^9, 
   3.716724718043242*^9, 3.716725395688067*^9, 3.716725463217031*^9, 
   3.7167257708948097`*^9, 3.7167258091296988`*^9, {3.716725896001905*^9, 
   3.71672590228013*^9}, 3.71672618202864*^9, 3.716726389943378*^9, 
   3.716726454307065*^9, 3.7167266495091877`*^9, 3.7167277962400837`*^9, {
   3.716727833578467*^9, 3.716727845308649*^9}, 3.71672880712514*^9, 
   3.7180842564631042`*^9, 
   3.7180896793840923`*^9},ExpressionUUID->"588b3424-b025-47d6-96bc-\
b1449a13b110"]
}, Open  ]]
},
WindowSize->{1280, 694},
WindowMargins->{{Automatic, 107}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 16, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1956, 55, 134, "Text", "ExpressionUUID" -> \
"17bf2c7d-9fb8-44a6-87af-8a6134826c47"],
Cell[2517, 77, 178, 6, 49, "Text", "ExpressionUUID" -> \
"73e6c6ba-35de-4dd5-8ce5-66026fd8007e"],
Cell[2698, 85, 5790, 152, 278, "Input", "ExpressionUUID" -> \
"f87970ff-fed9-4044-8315-7dbc78d2bc45"],
Cell[8491, 239, 226, 7, 49, "Text", "ExpressionUUID" -> \
"5af5665c-3b13-462c-9c29-153c4935cba2"],
Cell[8720, 248, 3815, 105, 189, "Input", "ExpressionUUID" -> \
"86d263fd-550e-4eb4-b5cf-cc718016e357"],
Cell[12538, 355, 6750, 156, 474, "Input", "ExpressionUUID" -> \
"6798ca66-f737-4285-8b9c-d0d601c5fa71"],
Cell[19291, 513, 3184, 59, 168, "Input", "ExpressionUUID" -> \
"268631f2-689b-4f0f-af2e-4e01db36ec74"],
Cell[22478, 574, 10379, 210, 789, "Input", "ExpressionUUID" -> \
"633038f7-3cf8-40c1-b72a-bd504ce71011"],
Cell[CellGroupData[{
Cell[32882, 788, 1027, 20, 96, "Input", "ExpressionUUID" -> \
"ecbad157-4bbb-4567-9e4e-0a8cd0b7a716"],
Cell[33912, 810, 1920, 47, 35, "Output", "ExpressionUUID" -> \
"1df465d3-fa1b-4b8d-81b7-cebf7c196187"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35869, 862, 416, 9, 32, "Input", "ExpressionUUID" -> \
"699be9cf-f9fb-4e70-b7ca-0e1676036072"],
Cell[36288, 873, 640, 19, 27, "Print", "ExpressionUUID" -> \
"2b1efc68-ae8d-4273-b803-ac00497e82de"],
Cell[36931, 894, 204, 4, 32, "Output", "ExpressionUUID" -> \
"e2a90ef5-751b-4ff4-b9f9-f80fd00c46a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37172, 903, 550, 13, 32, "Input", "ExpressionUUID" -> \
"c0b6c898-c0dc-4891-ba5b-070715350e2a"],
Cell[37725, 918, 6275, 149, 242, "Output", "ExpressionUUID" -> \
"588b3424-b025-47d6-96bc-b1449a13b110"]
}, Open  ]]
}
]
*)

