(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14721,        383]
NotebookOptionsPosition[     13725,        352]
NotebookOutlinePosition[     14082,        368]
CellTagsIndexPosition[     14039,        365]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "\nCombining Howard equations and the quadratic nature of value function of \
states in multiclass m/m/1-PS (Leino et al.),\nthe number of linear equations \
reduces to K ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"+", " ", 
     FractionBox[
      RowBox[{"K", "(", 
       RowBox[{"K", "-", "1"}], ")"}], "2"]}], " ", "+", " ", "K"}], 
   TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2649f56b-b871-4467-abb7-e933f830ceea"],
 ", i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    SuperscriptBox["K", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "4a87f0d8-76d0-4179-b5df-4fbab424f02a"],
 ")"
}], "Text",
 CellChangeTimes->{{3.716023110104619*^9, 3.716023381301321*^9}, {
  3.716023971365889*^9, 3.716023972517726*^9}, {3.716029257872757*^9, 
  3.7160292683830833`*^9}},ExpressionUUID->"17bf2c7d-9fb8-44a6-87af-\
8a6134826c47"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"generateCoef", "[", "numClasses_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "i", ",", "j", ",", "arow"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", "\[LessEqual]", "numClasses"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"arow", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "numClasses"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[GreaterEqual]", "j"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"arow", ",", 
                RowBox[{"Symbol", "[", 
                 RowBox[{"\"\<a\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}], "<>", 
                  RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"arow", ",", 
                RowBox[{"Symbol", "[", 
                 RowBox[{"\"\<a\>\"", "<>", 
                  RowBox[{"ToString", "[", "j", "]"}], "<>", 
                  RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"a", ",", " ", "arow"}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "a"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.716024616211174*^9, 3.7160246405701313`*^9}, {
  3.7160251987971773`*^9, 3.716025284349873*^9}, {3.7160254141792088`*^9, 
  3.7160254631092033`*^9}, {3.716025597609393*^9, 3.716025626425117*^9}, {
  3.716025689305264*^9, 3.716025694074237*^9}, {3.71602574014187*^9, 
  3.716025776637224*^9}, {3.716025910180739*^9, 3.716025994873652*^9}, {
  3.716026028262525*^9, 3.716026034632938*^9}, {3.7160261932916403`*^9, 
  3.716026295789319*^9}, {3.716026327948625*^9, 3.716026555044425*^9}, {
  3.716026637079072*^9, 3.716026637607843*^9}, {3.716026817598378*^9, 
  3.71602682034931*^9}, {3.716027017460964*^9, 3.7160270251877337`*^9}, {
  3.716032032342107*^9, 
  3.7160320518763323`*^9}},ExpressionUUID->"bac99482-c875-4b5d-9494-\
2bd0b0e0ff7f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"generateEquations", "[", 
    RowBox[{"arrRates_", ",", " ", "servRates_", ",", " ", "numClasses_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "equations", ",", "a"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"equations", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"generateCoef", "[", "numClasses", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"**", "generate"}], " ", "K", " ", "equations"}], ",", " ", 
        RowBox[{"K", "=", "numClasses"}]}], "***)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "numClasses"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"equations", ",", " ", 
          RowBox[{"1", " ", "+", " ", 
           RowBox[{"2", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"arrRates", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", 
               RowBox[{"a", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", " ", "i"}], "]"}], "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "numClasses"}], "}"}]}], "]"}]}], 
           " ", "-", 
           RowBox[{"2", " ", 
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", 
            RowBox[{"servRates", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"**", "generate"}], " ", "K", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"K", "-", "1"}], ")"}], "/", "2"}], " ", "equations"}], 
        ",", " ", 
        RowBox[{"K", "=", "numClasses"}]}], "***)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"numClasses", "-", "1"}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"i", "+", "1"}]}], ",", " ", 
          RowBox[{"j", "\[LessEqual]", "numClasses"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"equations", ",", " ", 
            RowBox[{"1", " ", "+", " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"arrRates", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", ",", " ", "i"}], "]"}], "]"}], "+", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}]}], ")"}]}], ",", 
               " ", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", "numClasses"}], "}"}]}], "]"}], 
             " ", "-", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
              RowBox[{"servRates", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"servRates", "[", 
               RowBox[{"[", "j", "]"}], "]"}], " ", 
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i"}], "]"}], "]"}]}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"**", "generate"}], " ", "K", " ", "equations"}], ",", " ", 
        RowBox[{"K", "=", "numClasses"}]}], "***)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "numClasses"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"equations", ",", " ", 
          RowBox[{
           RowBox[{"servRates", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<a\>\"", "<>", 
               RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "-", 
             RowBox[{"a", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}]}], ")"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "equations"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716027733206336*^9, 3.7160280034554443`*^9}, 
   3.716028775490158*^9, {3.716028865219819*^9, 3.7160288928043137`*^9}, {
   3.716028933893358*^9, 3.7160290538348494`*^9}, {3.716029429254259*^9, 
   3.716029574377687*^9}, {3.716029658796275*^9, 3.7160297403346853`*^9}, {
   3.7160297773141413`*^9, 3.716029842578601*^9}, {3.716029891748752*^9, 
   3.716029973686709*^9}, {3.716032134585272*^9, 
   3.716032159705655*^9}},ExpressionUUID->"609d29f7-0a0b-4f89-9d8a-\
cb6591f401a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"solveEquation", "[", 
     RowBox[{"arrRates_", ",", "servRates_", ",", " ", "numClasses_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"equations", " ", "=", " ", 
        RowBox[{"generateEquations", "[", 
         RowBox[{"arrRates", ",", "servRates", ",", "numClasses"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"zeros", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "equations", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"variables", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"generateCoef", "[", "numClasses", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ai", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<a\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numClasses"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"variables", ",", " ", "ai"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"variables", " ", "=", " ", 
        RowBox[{"Flatten", "[", "variables", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"solution", " ", "=", " ", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{"equations", " ", "\[Equal]", " ", "zeros"}], ",", " ", 
          "variables"}], "]"}]}], ";", "\[IndentingNewLine]", "solution"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"sol", " ", "=", " ", 
    RowBox[{"solveEquation", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}], ",", "2"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.716032377421318*^9, 3.716032558820561*^9}, {
  3.716032732505889*^9, 3.716032987314087*^9}, {3.716033128040325*^9, 
  3.716033129302466*^9}, {3.716033203625462*^9, 3.716033217943671*^9}, {
  3.716033265626913*^9, 
  3.716033266856365*^9}},ExpressionUUID->"3b92c66c-7331-45bb-9f6e-\
cabb8f248a09"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a11", "\[Rule]", 
     FractionBox["9", "8"]}], ",", 
    RowBox[{"a21", "\[Rule]", 
     FractionBox["7", "8"]}], ",", 
    RowBox[{"a22", "\[Rule]", 
     FractionBox["11", "16"]}], ",", 
    RowBox[{"a1", "\[Rule]", 
     FractionBox["9", "8"]}], ",", 
    RowBox[{"a2", "\[Rule]", 
     FractionBox["11", "16"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.716032988476536*^9, 3.716033130230751*^9, {3.716033218914258*^9, 
   3.7160332673785677`*^9}},ExpressionUUID->"16b58edc-d053-481e-baf7-\
6b7d19e04522"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Replace", "[", 
   RowBox[{"a11", ",", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.716033269546143*^9, 3.7160332987771606`*^9}, {
  3.716033391644588*^9, 
  3.716033397279243*^9}},ExpressionUUID->"7c12f829-670c-4ba8-9b22-\
ce15266a699e"],

Cell[BoxData[
 FractionBox["9", "8"]], "Output",
 CellChangeTimes->{{3.716033277965185*^9, 3.716033299405616*^9}, 
   3.716033398008761*^9},ExpressionUUID->"49842a0b-b4b3-46e0-9611-\
cd7e341d03ed"]
}, Open  ]]
},
WindowSize->{1053, 911},
WindowMargins->{{Automatic, 116}, {Automatic, 33}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 16, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 922, 26, 77, "Text", "ExpressionUUID" -> \
"17bf2c7d-9fb8-44a6-87af-8a6134826c47"],
Cell[1483, 48, 2815, 59, 327, "Input", "ExpressionUUID" -> \
"bac99482-c875-4b5d-9494-2bd0b0e0ff7f"],
Cell[4301, 109, 5715, 137, 516, "Input", "ExpressionUUID" -> \
"609d29f7-0a0b-4f89-9d8a-cb6591f401a9"],
Cell[CellGroupData[{
Cell[10041, 250, 2481, 60, 285, "Input", "ExpressionUUID" -> \
"3b92c66c-7331-45bb-9f6e-cabb8f248a09"],
Cell[12525, 312, 590, 17, 49, "Output", "ExpressionUUID" -> \
"16b58edc-d053-481e-baf7-6b7d19e04522"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13152, 334, 357, 9, 54, "Input", "ExpressionUUID" -> \
"7c12f829-670c-4ba8-9b22-ce15266a699e"],
Cell[13512, 345, 197, 4, 49, "Output", "ExpressionUUID" -> \
"49842a0b-b4b3-46e0-9611-cd7e341d03ed"]
}, Open  ]]
}
]
*)

